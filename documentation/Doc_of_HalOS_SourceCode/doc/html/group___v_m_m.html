<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Halos: Virtual Memory Management</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Virtual Memory Management<br>
<small>
[<a class="el" href="group___k_e_r_n_e_l.html">Halos Kernel</a>]</small>
</h1>Virtual Memory Management. The central communication point to other modules. Especially <a class="el" href="struct_process.html">Process</a> Loading and Unloading is supported from the module. Only the Memory Exceptions undergo this module border.  
<a href="#_details">More...</a>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Modules</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m___h_a_t.html">Hash Anchor Table</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">description of Hash Anchor Table <br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m___h_e_a_p.html">Heap Management</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Heap Management to add dynamically allocated regions to <a class="el" href="struct_process.html">Process</a> Region Table. Benefits: + Free all Pages at process termination + Memory Protection at Page Level. <br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m___h_e_x.html">iHex Parser</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">iHex Parser. Should transform iHex <a class="el" href="struct_process.html">Process</a> Images to Bin <a class="el" href="struct_process.html">Process</a> Images. Not used at the moment. <br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m___i_p_t.html">Inverted Page Table</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Inverted Page Table. The basic idea of an inverted page table is to have only one page table for the complete memory and all loaded processes. The entries identify the physical frames rather than the virtual pages. The main advantage is that no TLB flush is necessary between process switches. Another advantage is that the memory usage of the page table is moderate. The search speed of a given Page Table Entry depends heavily on the hash-algorithm that uses ASID and VPN. With a goog hash-algorithm two to three lookups are necessary. A disadvantage is that no memory sharing is possible with the standard variant. <br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m___l_d_r.html">Loader</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Loader. The Loader loads the complete <a class="el" href="struct_process.html">Process</a> Image into Virtual Memory. This causes multiple initial page faults which actualize the TLB. <br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m___p_t.html">Page Table</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The Page Table consists of two parts, namely the Hash Anchor Table and the Inverted Page Table. This is to improve the search speed via a hashing algorithm for given ASID-VPN combinations. The init-, search-, update- and free-methods should be used from Memory Management to handle the Page Table, other methods are for internal use only. <br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m___p_t_e.html">Page Table Entry</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Page Table Entry. Holds the TLB High and Low part that could also be found in the TLB. Essentially holds virtual Addresses and ASID (High) and physical Addresses (Low) along with other data. <br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m___p_r_t.html">Process Region Table</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The <a class="el" href="struct_process.html">Process</a> Region Table should manage the regions and access-rights for a given process. Swapping and Demand-Paging links to different Page Tables. At the moment no swapping is supported and the <a class="el" href="struct_process.html">Process</a> Region Table is simply used for unloading the process from the virtual memory system. <br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m___t_l_b.html">Transition Lookaside Buffer</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Transition Lookaside Buffer. Manages the 32 data entries of the AVR32 AP7000. Used by memory exception handler. <br></td></tr>

<p>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m.html#g243fac608384b4b91246e465a206e72d">initMemoryManagement</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m.html#g95c733b81f5f912811660319f6dede57">switchMemoryManagementToAppLoadMode</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m.html#g5c5572a6e8f5df265dd936c6e3e9c062">switchMemoryManagementToAppRunMode</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m.html#g818719d1d1577fd4cb90e1ef13994386">actualiseASID</a> (uint32_t pid)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">BOOL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m.html#gfbd1dbe50bf30f665f1a4fc181655778">loadProcessInMemorySystem</a> (int ASID, BinImagePtr pBinImage)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">BOOL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m.html#g8769d0f39e7a7bab4a27e72db8b31ef3">unloadProcessFromMemorySystem</a> (int ASID)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Virtual Memory Management. The central communication point to other modules. Especially <a class="el" href="struct_process.html">Process</a> Loading and Unloading is supported from the module. Only the Memory Exceptions undergo this module border. 
<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>... </dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>drb8w </dd></dl>
<dl class="version" compact><dt><b>Version:</b></dt><dd>0.0.1 </dd></dl>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="g818719d1d1577fd4cb90e1ef13994386"></a><!-- doxytag: member="MemoryManagement.h::actualiseASID" ref="g818719d1d1577fd4cb90e1ef13994386" args="(uint32_t pid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void actualiseASID           </td>
          <td>(</td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>pid</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the given pid as ASID. Used especially for loading purposes. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pid</em>&nbsp;</td><td>the process id that should be the ASID. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="g243fac608384b4b91246e465a206e72d"></a><!-- doxytag: member="MemoryManagement.h::initMemoryManagement" ref="g243fac608384b4b91246e465a206e72d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int initMemoryManagement           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Central Place for all Memory Interactions. Initialize Page Table, set page table base register, reset and initialize MMU and MMU-Exceptions. 
</div>
</div><p>
<a class="anchor" name="gfbd1dbe50bf30f665f1a4fc181655778"></a><!-- doxytag: member="MemoryManagement.h::loadProcessInMemorySystem" ref="gfbd1dbe50bf30f665f1a4fc181655778" args="(int ASID, BinImagePtr pBinImage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL loadProcessInMemorySystem           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ASID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BinImagePtr&nbsp;</td>
          <td class="paramname"> <em>pBinImage</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Loads the <a class="el" href="struct_process.html">Process</a> Image in Memory. Actualise RegionTable, <a class="el" href="struct_page_table.html">PageTable</a> and TLB. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ASID</em>&nbsp;</td><td>the PID of the process in charge </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pBinImage</em>&nbsp;</td><td>the Image of the process </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>TRUE if successful, FALSE otherwise </dd></dl>

</div>
</div><p>
<a class="anchor" name="g95c733b81f5f912811660319f6dede57"></a><!-- doxytag: member="MemoryManagement.h::switchMemoryManagementToAppLoadMode" ref="g95c733b81f5f912811660319f6dede57" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void switchMemoryManagementToAppLoadMode           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
State should be held in <a class="el" href="struct_process.html">Process</a> Management. Unused at the moment. 
</div>
</div><p>
<a class="anchor" name="g5c5572a6e8f5df265dd936c6e3e9c062"></a><!-- doxytag: member="MemoryManagement.h::switchMemoryManagementToAppRunMode" ref="g5c5572a6e8f5df265dd936c6e3e9c062" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void switchMemoryManagementToAppRunMode           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
State should be held in <a class="el" href="struct_process.html">Process</a> Management. Unused at the moment. 
</div>
</div><p>
<a class="anchor" name="g8769d0f39e7a7bab4a27e72db8b31ef3"></a><!-- doxytag: member="MemoryManagement.h::unloadProcessFromMemorySystem" ref="g8769d0f39e7a7bab4a27e72db8b31ef3" args="(int ASID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL unloadProcessFromMemorySystem           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ASID</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Unloads process with given ASID from all Pagers i.e. from RamPage and SwapPage. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ASID</em>&nbsp;</td><td>the PID of the process </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>true if a complete remove of all Memory and Swap-Resources was successful, false otherwise </dd></dl>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sun Feb 8 18:43:25 2009 for Halos by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
