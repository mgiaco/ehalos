<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Halos: Process Control Block (PCB)</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Process Control Block (PCB)<br>
<small>
[<a class="el" href="group___p_r_o_c_e_s_s___m_a_n_a_g_e_r.html">Process Manager</a>]</small>
</h1><a class="el" href="struct_process.html">Process</a> Control Block (PCB), structs and routines for creating tasks (PCB´s), MMU initializing and starting tasks.  
<a href="#_details">More...</a>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structprocess_control_block.html">processControlBlock</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Control Block for holding all the task informations, used mainly by the schuduler.  <a href="structprocess_control_block.html#_details">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g4cc9b44b9d0676b3f2ed29949017f889"></a><!-- doxytag: member="PCB::REGISTER_STACK_SIZE" ref="g4cc9b44b9d0676b3f2ed29949017f889" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_c_b.html#g4cc9b44b9d0676b3f2ed29949017f889">REGISTER_STACK_SIZE</a>&nbsp;&nbsp;&nbsp;20</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">constant for stack size <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g3cf3e9b0bf546d9629508ba4ec4b7c50"></a><!-- doxytag: member="PCB::REGISTER_0_OFFSET" ref="g3cf3e9b0bf546d9629508ba4ec4b7c50" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_c_b.html#g3cf3e9b0bf546d9629508ba4ec4b7c50">REGISTER_0_OFFSET</a>&nbsp;&nbsp;&nbsp;16</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">constant for register 0 offset <br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structprocess_control_block.html">PCtrlBlock_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_c_b.html#g387d4213f53fdf9464524819d03cab62">processCreate</a> (processFkt pFkt, const char *pName, uint32_t stackSize)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structprocess_control_block.html">PCtrlBlock_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_c_b.html#ga67eb0979dcbd97d5e1a1023cf2bbe09">mmuProcessCreate</a> (uint32_t virtualLoadAddress, const char *pName)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_c_b.html#g8e154be3f7e3b394bfe771ba2b73fc07">start_first_process</a> (<a class="el" href="structprocess_control_block.html">PCtrlBlock_t</a> *pcb) __attribute__((naked))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_c_b.html#g70927fcffcb94cf5e5489161c8bc5a47">setup_and_start_new_process</a> (char *processName)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_c_b.html#g1ee7e6105aedabb1f1aa0cf8e77b453b">setupFirstProcess</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_c_b.html#g5a00b737864b285963b61f755d34629b">startFirstProcess</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g186be0def8dfc704f43e446e25c5d5d4"></a><!-- doxytag: member="PCB::BinImages" ref="g186be0def8dfc704f43e446e25c5d5d4" args="[]" -->
BinImage&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_c_b.html#g186be0def8dfc704f43e446e25c5d5d4">BinImages</a> []</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="struct_binary.html">Binary</a> images for the tasks we want to load (holds all the memory adresses to our applications like idle-task, shell, space invaders, ...) [0] = idle process [1] = shell process [2] = space invaders game. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="gf190a046213a394375f51fa3fe5e4bdb"></a><!-- doxytag: member="PCB::activeASID" ref="gf190a046213a394375f51fa3fe5e4bdb" args="" -->
uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_c_b.html#gf190a046213a394375f51fa3fe5e4bdb">activeASID</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">current active ASID for MMU <br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<a class="el" href="struct_process.html">Process</a> Control Block (PCB), structs and routines for creating tasks (PCB´s), MMU initializing and starting tasks. 
<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>... </dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>maex.sp Markus Speckle </dd></dl>
<dl class="version" compact><dt><b>Version:</b></dt><dd>0.0.0.1 </dd></dl>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="ga67eb0979dcbd97d5e1a1023cf2bbe09"></a><!-- doxytag: member="pcb.h::mmuProcessCreate" ref="ga67eb0979dcbd97d5e1a1023cf2bbe09" args="(uint32_t virtualLoadAddress, const char *pName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structprocess_control_block.html">PCtrlBlock_t</a>* mmuProcessCreate           </td>
          <td>(</td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>virtualLoadAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>pName</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates a process with MMU support and with defined name and stacksize <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>virtualLoadAddress</em>&nbsp;</td><td>load address for MMU </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pName</em>&nbsp;</td><td>name of the process (shell, space invaders, picture frame application, ...) </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>pointer to the new created process </dd></dl>

</div>
</div><p>
<a class="anchor" name="g387d4213f53fdf9464524819d03cab62"></a><!-- doxytag: member="pcb.h::processCreate" ref="g387d4213f53fdf9464524819d03cab62" args="(processFkt pFkt, const char *pName, uint32_t stackSize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structprocess_control_block.html">PCtrlBlock_t</a>* processCreate           </td>
          <td>(</td>
          <td class="paramtype">processFkt&nbsp;</td>
          <td class="paramname"> <em>pFkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>pName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>stackSize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
TASK_SWITCH_TESTING function: Creates a process with defined name and stacksize, this method is only used for simple task switching (without nay MMU/memory management support!) <dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___p_c_b.html#ga67eb0979dcbd97d5e1a1023cf2bbe09">mmuProcessCreate</a>(...) </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pFkt</em>&nbsp;</td><td>process function pointer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pName</em>&nbsp;</td><td>name of the process (shell, space invaders, picture frame application, ...) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>stackSize</em>&nbsp;</td><td>stack size </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>pointer to the new created process </dd></dl>

<p>
* Setup the newly allocated TCB with the initial state of the task. */ 
</div>
</div><p>
<a class="anchor" name="g70927fcffcb94cf5e5489161c8bc5a47"></a><!-- doxytag: member="pcb.h::setup_and_start_new_process" ref="g70927fcffcb94cf5e5489161c8bc5a47" args="(char *processName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_and_start_new_process           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>processName</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Loads the given process from the defined BinImages, used for SYSTEMCALL E.g. shell starts new process like space invaders, function creates a new <a class="el" href="struct_process.html">Process</a> Control Block (PCB), creates process in the MMU, ASID MMU management and puts PCB to the scheduler as a new runnable task <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>processName</em>&nbsp;</td><td>name of the process to init </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>nothing </dd></dl>

</div>
</div><p>
<a class="anchor" name="g1ee7e6105aedabb1f1aa0cf8e77b453b"></a><!-- doxytag: member="pcb.h::setupFirstProcess" ref="g1ee7e6105aedabb1f1aa0cf8e77b453b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setupFirstProcess           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create and load first process, first process is the Idle process ==&gt; this process is used for measurement and runs only if no other runnable process is available, idle task starts directly the shell as first real applications (so the user can interact via GUI with HALOS) <dl class="return" compact><dt><b>Returns:</b></dt><dd>nothing </dd></dl>

</div>
</div><p>
<a class="anchor" name="g8e154be3f7e3b394bfe771ba2b73fc07"></a><!-- doxytag: member="pcb.h::start_first_process" ref="g8e154be3f7e3b394bfe771ba2b73fc07" args="(PCtrlBlock_t *pcb) __attribute__((naked))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void start_first_process           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structprocess_control_block.html">PCtrlBlock_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pcb</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Loads the given process into the the current registers, PC, SP, LR, R0 - R12, ... <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pcb</em>&nbsp;</td><td>process control block of the process we want to load </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>nothing </dd></dl>

</div>
</div><p>
<a class="anchor" name="g5a00b737864b285963b61f755d34629b"></a><!-- doxytag: member="pcb.h::startFirstProcess" ref="g5a00b737864b285963b61f755d34629b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void startFirstProcess           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Starts first process ==&gt; Idle Task, this task automatically starts the shell as a the first real user application (GUI interface) <dl class="return" compact><dt><b>Returns:</b></dt><dd>nothing </dd></dl>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Thu Feb 5 20:41:40 2009 for Halos by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
