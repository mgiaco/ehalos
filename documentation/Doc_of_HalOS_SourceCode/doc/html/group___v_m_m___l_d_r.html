<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Halos: Loader</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Loader<br>
<small>
[<a class="el" href="group___v_m_m.html">Virtual Memory Management</a>]</small>
</h1>Loader. The Loader loads the complete <a class="el" href="struct_process.html">Process</a> Image into Virtual Memory. This causes multiple initial page faults which actualize the TLB.  
<a href="#_details">More...</a>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_binary.html">Binary</a></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">BOOL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m___l_d_r.html#gaf0bee09e9416fef2ebaa23cd84c329b">loadBinApplication</a> (BinImagePtr pBinImage, int ASID)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m___l_d_r.html#gee5032b8bccc629d554bd321d74a71a5">startBinApplication</a> (BinImagePtr pBinImage, int ASID)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m___l_d_r.html#gfa3edc54147d22b0e8e45491140576cb">stopBinApplication</a> (BinImagePtr pBinImage, int ASID)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">BOOL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m___l_d_r.html#gef6344ddde662c01f04ed17a53e80291">unloadBinApplication</a> (BinImagePtr pBinImage, int ASID)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">BOOL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m___l_d_r.html#g0b60ccd1a0871b94620f9206fc9e86a6">reservePagesForBinImage</a> (BinImagePtr pBinImage, int ASID)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">BOOL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m___l_d_r.html#g2774925688551490cf567ca10eddd33c">writeBinImageToVirtualRam</a> (BinImagePtr pBinImage, int ASID)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_m_m___l_d_r.html#ga457b6bb7d7447760750e4315be37e14">nrOfPagesForBinImage</a> (BinImagePtr pBinImage)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Loader. The Loader loads the complete <a class="el" href="struct_process.html">Process</a> Image into Virtual Memory. This causes multiple initial page faults which actualize the TLB. 
<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>... </dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>drb8w </dd></dl>
<dl class="version" compact><dt><b>Version:</b></dt><dd>0.0.1 </dd></dl>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="gaf0bee09e9416fef2ebaa23cd84c329b"></a><!-- doxytag: member="Loader.h::loadBinApplication" ref="gaf0bee09e9416fef2ebaa23cd84c329b" args="(BinImagePtr pBinImage, int ASID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL loadBinApplication           </td>
          <td>(</td>
          <td class="paramtype">BinImagePtr&nbsp;</td>
          <td class="paramname"> <em>pBinImage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ASID</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Load raw process image into memory. Stack and heap allocation is done by application. Steps: + reserve pages for BinImage + write BinImage to Virtual Ram<p>
Load raw process image into memory. Stack and heap allocation is done by application. Problem: intentionally causes page faults. How to separate from illegal memory-access? Done by state of process. At the moment loading copies complete process image. That means that the right number of pages are reserved to appropriate process image size and copying is done afterwords. 
</div>
</div><p>
<a class="anchor" name="ga457b6bb7d7447760750e4315be37e14"></a><!-- doxytag: member="Loader.h::nrOfPagesForBinImage" ref="ga457b6bb7d7447760750e4315be37e14" args="(BinImagePtr pBinImage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nrOfPagesForBinImage           </td>
          <td>(</td>
          <td class="paramtype">BinImagePtr&nbsp;</td>
          <td class="paramname"> <em>pBinImage</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Determines how many pages must be reserved for that binary process image. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pBinImage</em>&nbsp;</td><td>the image to be analysed </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="g0b60ccd1a0871b94620f9206fc9e86a6"></a><!-- doxytag: member="Loader.h::reservePagesForBinImage" ref="g0b60ccd1a0871b94620f9206fc9e86a6" args="(BinImagePtr pBinImage, int ASID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL reservePagesForBinImage           </td>
          <td>(</td>
          <td class="paramtype">BinImagePtr&nbsp;</td>
          <td class="paramname"> <em>pBinImage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ASID</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Determines the necessary number of pages of the BinImage and reserves them in the Inverted Page Table. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pBinImage</em>&nbsp;</td><td>the binary process image </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ASID</em>&nbsp;</td><td>the ASID for the corresponding running process </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="gee5032b8bccc629d554bd321d74a71a5"></a><!-- doxytag: member="Loader.h::startBinApplication" ref="gee5032b8bccc629d554bd321d74a71a5" args="(BinImagePtr pBinImage, int ASID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void startBinApplication           </td>
          <td>(</td>
          <td class="paramtype">BinImagePtr&nbsp;</td>
          <td class="paramname"> <em>pBinImage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ASID</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
BinImage is nec if e.g. startaddress is not 0x0000. Unused at the moment.<p>
Starts raw binary application. BinImage is nec if e.g. startaddress is not 0x0000 
</div>
</div><p>
<a class="anchor" name="gfa3edc54147d22b0e8e45491140576cb"></a><!-- doxytag: member="Loader.h::stopBinApplication" ref="gfa3edc54147d22b0e8e45491140576cb" args="(BinImagePtr pBinImage, int ASID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stopBinApplication           </td>
          <td>(</td>
          <td class="paramtype">BinImagePtr&nbsp;</td>
          <td class="paramname"> <em>pBinImage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ASID</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Unused at the moment. 
</div>
</div><p>
<a class="anchor" name="gef6344ddde662c01f04ed17a53e80291"></a><!-- doxytag: member="Loader.h::unloadBinApplication" ref="gef6344ddde662c01f04ed17a53e80291" args="(BinImagePtr pBinImage, int ASID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL unloadBinApplication           </td>
          <td>(</td>
          <td class="paramtype">BinImagePtr&nbsp;</td>
          <td class="paramname"> <em>pBinImage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ASID</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Unloads the binary process image from memory. That means remove it from the page table system. Unused at the moment. 
</div>
</div><p>
<a class="anchor" name="g2774925688551490cf567ca10eddd33c"></a><!-- doxytag: member="Loader.h::writeBinImageToVirtualRam" ref="g2774925688551490cf567ca10eddd33c" args="(BinImagePtr pBinImage, int ASID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL writeBinImageToVirtualRam           </td>
          <td>(</td>
          <td class="paramtype">BinImagePtr&nbsp;</td>
          <td class="paramname"> <em>pBinImage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ASID</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Writes raw binary image to ram. During writing multiple page faults will occur. Because context is the context of OS not of application it is necessary to use the actual ASID also in OS Mode. The image is written from back to front to assure that the start page is in the TLB at prosess start. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pBinImage</em>&nbsp;</td><td>the image that is written to virtual Ram </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ASID</em>&nbsp;</td><td>the PID of the corresponding process</td></tr>
  </table>
</dl>
Writes raw binary image to ram. During writing multiple page faults will occur. Problem: Context is the context of OS NOT of application! It is necessary to use the actual ASID also in OS Mode. Alternatively write to Physical RAM via direct mapped memory and offset 0xA000000. 
</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sun Feb 8 18:43:25 2009 for Halos by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
